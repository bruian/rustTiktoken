# Минимальная библиотека для R, которая считает количество токенов в промте

## Кратко о R пакетах
  - [OpenAI token counting](https://github.com/openai/openai-cookbook/blob/main/examples/How_to_count_tokens_with_tiktoken.ipynb)
  - [RUST tiktoken](https://github.com/zurawiki/tiktoken-rs)
  - [R packages](https://kbroman.org/pkg_primer/)
  - [Book of R packages](https://r-pkgs.org/)

  Каждый R пакет должен содержать файл **DESCRIPTION**, который содержит метаданные о пакете. В этом файле должны быть указаны зависимости от других пакетов, которые будут установлены автоматически при установке пакета. В файле DESCRIPTION также указывается версия пакета, которая должна быть увеличена при каждом обновлении пакета. В файле DESCRIPTION также указывается автор пакета, его контакты и лицензия.

  Помимо файла DESCRIPTION, пакет должен содержать файл **NAMESPACE**, который содержит список экспортируемых функций пакета. Экспортируемые функции могут быть вызваны из других пакетов. Неэкспортируемые функции могут быть вызваны только изнутри пакета.

  Так же пакет должен содержать директорию **R**, в которой находятся файлы с функциями пакета. Функции пакета должны быть экспортированы в файле NAMESPACE.

  R пакет будет неправильным без документации. Она располагается в директории **man**, и должна содержать файлы в формате Rd. Файлы в формате Rd содержат описание функций пакета, а также примеры их использования. Документация должна быть написана на английском языке. Но вам не обязательно писать документацию самостоятельно. Вы можете использовать пакет [roxygen2](https://cran.r-project.org/web/packages/roxygen2/index.html), который автоматически создаст файлы Rd из комментариев в коде функций.

  Вы должны находиться на уровень выше директории с файлом DESCRIPTION, чтобы выполнить команду ``R CMD build rustTiktoken``. Это создаст архив с именем, соответствующим имени пакета и версии, например, rustTiktoken_1.0.0.tar.gz. Этот архив можно установить с помощью ``R CMD INSTALL rustTiktoken_1.0.0.tar.gz``.

  Затем в R можно загрузить библиотеку командой ``library(rustTiktoken)``. После этого можно вызвать функции библиотеки.

  Для использования roxygen2 сперва необходимо перейти в директорию с rustTiktoken и установить пакет devtools (install.packages("devtools")). Пакет может потребовать следующие зависимости и библиотеки OS (указаны в скобках).

  systemfonts (libfontconfig1-dev)
  textshaping (libharfbuzz-dev libfribidi-dev)
  ragg (libfreetype6-dev libpng-dev libtiff5-dev libjpeg-dev)
  pkgdown

  После установки пакета и зависимостей. Библиотеку devtools необходимо загрузить ``library(devtools)``. Затем необходимо сформировать документацию и файл NAMESPACE командой ``document()``. После этого можно собрать пакет командой ``build()``. После этого можно установить пакет командой ``install()``.
